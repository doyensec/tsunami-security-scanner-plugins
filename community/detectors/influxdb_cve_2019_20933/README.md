# CVE-2019-20933 VulnDetector

InfluxDB before 1.7.6 has an authentication bypass vulnerability in the authenticate function in
services/httpd/handler.go because a JWT token may have an empty SharedSecret (aka shared secret).

# Missing authentication in InfluxDB 1.x

This plugin also checks for missing authentication in InfluxDB 1.x versions.

The authentication doesn't enable by default in the influxDB generated config file
to enable authentication you must:

1. change  `auth-enabled = false` to `auth-enabled = true` in your influxDB config file that
   initially can be generated by following command:
   `docker run --rm influxdb:1.x influxd config > influxdb.conf`
2. according to [documentation](https://github.com/docker-library/docs/blob/master/influxdb/README.md#influxdb_admin_user) you must set a value for `INFLUXDB_ADMIN_USER` environment variable (with `-e` switch) to enable authentication.

InfluxDB version after 2 has a web setup instruction after first run, and you will be prompt to add username and password before start using InfluxDB.

- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20933
- https://github.com/docker-library/docs/blob/master/influxdb/README.md

## Build jar file for this plugin

Using `gradlew`:

```shell
./gradlew jar
```

Tsunami identifiable jar file is located at `build/libs` directory.
