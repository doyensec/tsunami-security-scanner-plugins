package com.google.tsunami.plugins.detectors.rce.torchserve;

import org.checkerframework.checker.nullness.qual.Nullable;
import javax.inject.Inject;

import com.google.tsunami.common.net.http.HttpClient;
import com.google.tsunami.plugin.payload.PayloadGenerator;
import com.google.tsunami.proto.NetworkService;

/**
 * A mock TorchServeExploiter that allows us to set the Details object returned by the isServiceVulnerable method.
 */
public class MockTorchServeExploiter extends TorchServeExploiter {
    @Inject
    public MockTorchServeExploiter(
            TorchServeManagementApiConfig config,
            TorchServeManagementApiArgs args,
            HttpClient httpClient,
            PayloadGenerator payloadGenerator,
            TorchServeManagementAPIExploiterWebServer webServer,
            TorchServeRandomUtils randomUtils) {
        super(config, args, httpClient, payloadGenerator, webServer, randomUtils);
    }

    public boolean returnNullDetails = false;

    // Override the method to return the mock details
    @Override
    public @Nullable Details isServiceVulnerable(NetworkService service) {
        return returnNullDetails ? null : this.details;
    }
}
